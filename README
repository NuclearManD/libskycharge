//// BUILD ARM PACKAGES IN CHROOT ENV

losetup -o $((8192<<9))  /dev/loop0 ./bone-debian-9.4-iot-armhf-2018-06-17-4gb.img
mount /dev/loop0 /mnt

mount -t proc fff /mnt/proc
mount -t sysfs fff /mnt/sys
mount -t devtmpfs fff /mnt/dev

apt-get install qemu-user-static
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
   chroot /mnt qemu-arm-static /bin/bash

dpkg-buildpackage -us -uc


///// GPSD INFO

http://beaglebone.cameon.net/home/serial-ports-uart

The UARTs map to pins and devices like this:

		  RX	 TX		  CTS	 RTS	 Device			Remark
 UART0	 J1_4	 J1_5					 /dev/ttyO0		BeagleBone Black only
 UART1	 P9_26	 P9_24	 P9_20	 P9_19	 /dev/ttyO1
 UART2	 P9_22	 P9_21	 P8_37	 P8_38	 /dev/ttyO2
 UART3	 P9_42	 P8_36	 P8_34			 /dev/ttyO3		TX only
 UART4	 P9_11	 P9_13	 P8_35	 P8_33	 /dev/ttyO4
 UART5	 P8_38	 P8_37	 P8_31	 P8_32	 /dev/ttyO5


https://stackoverflow.com/questions/35881761/enabling-uart-on-beaglebone-black

Do not forget to enable pins:

# set
config-pin P9.24 uart
config-pin P9.26 uart

# get
config-pin -q P9.24
config-pin -q P9.26

screen /dev/ttyO1 9600
screen /dev/ttyO1 38400 (BN-800)


For bbone should be systemd service written:

https://gist.github.com/pdp7/d4770a6ba17e666848796bf5cfd0caee

----
[Unit]
Description=Enable UART1 pins
After=generic-board-startup.service
Before=gpsd.service

[Service]
Type=simple
ExecStart=/bin/sh -c "config-pin P9.24 uart && config-pin P9.26 uart"

[Install]
WantedBy=multi-user.target
---

systemctl enable enable-uart1-pins.service
#### DONT FORGET TO REMOVE THIS FILE!!! WE USE USB NOW, SO NO NEED

systemctl enable gpsd.service



////

*** There is a hidden behavior of the "-n" option of "gpsd".
*** If this option is not set, the communication via shared memory is absent.

vim /etc/defaults/gpsd
#   DEVICES="/dev/ttyO1"
   GPSD_OPTIONS="-n"


apt install gpsd
systemctl stop gpsd.socket
systemctl stop gpsd.service
gpsd -D 5 -N -n /dev/tty01
